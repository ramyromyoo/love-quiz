import React, { useState, useEffect } from "react";
import { motion } from "framer-motion";

const questions = [
  { question: "Ø±Ø§Ù…ÙŠ Ø´Ø§Ù Ø³Ø§Ø±Ø© Ù„Ø£ÙˆÙ„ Ù…Ø±Ø© Ø§Ù…ØªÙ‰ØŸ", options: ["1 Ø£Ø¨Ø±ÙŠÙ„", "6 Ø£Ø¨Ø±ÙŠÙ„", "11 Ø£Ø¨Ø±ÙŠÙ„"], answer: "1 Ø£Ø¨Ø±ÙŠÙ„" },
  { question: "Ø¥ÙŠÙ‡ Ø£ÙƒØªØ± Ø­Ø§Ø¬Ø© Ø®Ù„Øª Ø±Ø§Ù…ÙŠ ÙŠØ±ØªØ§Ø­ Ù„Ø³Ø§Ø±Ø©ØŸ", options: ["Ø¶Ø­ÙƒØªÙ‡Ø§", "Ø¹Ø¯Ù… ÙˆØ¶Ø¹Ù‡Ø§ Ù„Ù„Ù…ÙƒÙŠØ§Ø¬", "Ù„Ø¨Ø³Ù‡Ø§"], answer: "Ø¹Ø¯Ù… ÙˆØ¶Ø¹Ù‡Ø§ Ù„Ù„Ù…ÙƒÙŠØ§Ø¬" },
  { question: "Ø¥Ù…ØªÙ‰ ØªÙ…Øª Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„ÙØ§ØªØ­Ø©ØŸ", options: ["6 Ø£Ø¨Ø±ÙŠÙ„", "11 Ø£Ø¨Ø±ÙŠÙ„", "1 Ø£Ø¨Ø±ÙŠÙ„"], answer: "6 Ø£Ø¨Ø±ÙŠÙ„" },
  { question: "Ù…ÙŠÙ† Ø§Ù„Ù„ÙŠ Ù†Ø³ÙŠ ÙŠØ¬ÙŠØ¨ Ø§Ù„Ø¬Ø§ØªÙˆÙ‡ ÙˆØ§Ù„Ø­Ø§Ø¬Ø© Ø§Ù„Ø³Ø§Ù‚Ø¹Ø©ØŸ", options: ["Ø±Ø§Ù…ÙŠ", "Ø®Ø§Ù„Ù‡", "ÙˆØ§Ù„Ø¯Ù‡"], answer: "Ø®Ø§Ù„Ù‡" },
  { question: "Ø¥ÙŠÙ‡ Ø§Ù„Ù„ÙŠ Ø¹Ø¬Ø¨ Ø³Ø§Ø±Ø© ÙÙŠ Ø±Ø§Ù…ÙŠ Ø£ÙˆÙ„ Ù…Ø±Ø©ØŸ", options: ["Ù‡Ø¯ÙˆØ¡Ù‡", "ÙˆØ³Ø§Ù…ØªÙ‡", "Ø«Ù‚ØªÙ‡ ÙÙŠ Ù†ÙØ³Ù‡"], answer: "Ø«Ù‚ØªÙ‡ ÙÙŠ Ù†ÙØ³Ù‡" },
  { question: "Ø³Ø§Ø±Ø© Ø²Ø¹Ù„Øª Ù„ÙŠÙ‡ ÙˆÙ‡ÙŠ Ø¨ØªØ®ØªØ§Ø± Ø§Ù„Ø¯Ù‡Ø¨ØŸ", options: ["Ø¹Ù„Ø´Ø§Ù† Ù…ÙƒÙ†ØªØ´ Ø¨ØªØ­Ø¨Ù‡", "Ø¹Ù„Ø´Ø§Ù† Ø£Ø®ØªÙ‡Ø§ Ù…Ù†Ø§Ø± Ù…Ø¬ØªØ´ Ù…Ø¹Ø§Ù‡Ø§", "Ø¹Ù„Ø´Ø§Ù† ØºØ§Ù„ÙŠ"], answer: "Ø¹Ù„Ø´Ø§Ù† Ø£Ø®ØªÙ‡Ø§ Ù…Ù†Ø§Ø± Ù…Ø¬ØªØ´ Ù…Ø¹Ø§Ù‡Ø§" },
  { question: "Ø£ÙƒØªØ± Ø­Ø§Ø¬Ø© Ø¨ØªØ­Ø±Ø¬ Ø³Ø§Ø±Ø© Ù…Ù† Ø±Ø§Ù…ÙŠØŸ", options: ["ØµÙˆØªÙ‡ Ø§Ù„Ø¹Ø§Ù„ÙŠ", "Ù†Ø¸Ø±Ø§ØªÙ‡ Ù„ÙŠÙ‡Ø§", "Ù‡Ø²Ø§Ø±Ù‡ Ø§Ù„ÙƒØªÙŠØ±"], answer: "Ù†Ø¸Ø±Ø§ØªÙ‡ Ù„ÙŠÙ‡Ø§" },
  { question: "Ø³Ø§Ø±Ø© Ø¨ØªØ­Ø¨ ØªØ´Ø±Ø¨ Ø¥ÙŠÙ‡ØŸ", options: ["ÙŠØ§Ù†Ø³ÙˆÙ†", "Ø³Ø­Ù„Ø¨", "Ø§Ù„Ø´Ø§ÙŠ"], answer: "Ø§Ù„Ø´Ø§ÙŠ" },
  { question: "Ø±Ø§Ù…ÙŠ Ø¨ÙŠØ­Ø¨ Ø¥ÙŠÙ‡ØŸ", options: ["Ø§Ù„Ø´Ø§ÙŠ", "Ø§Ù„ØªÙØ§Ø­ Ùˆ Ø§Ù„ÙŠØ§Ù†Ø³ÙˆÙ†", "Ø§Ù„Ù‚Ù‡ÙˆØ©"], answer: "Ø§Ù„ØªÙØ§Ø­ Ùˆ Ø§Ù„ÙŠØ§Ù†Ø³ÙˆÙ†" },
  { question: "Ø³Ø§Ø±Ø© Ø²Ø¹Ù„Øª Ù„Ù…Ø§ Ø¬Ø§Ø¨Ù„Ù‡Ø§ Ø±Ø§Ù…ÙŠØŸ", options: ["Ù…ÙˆØ¨Ø§ÙŠÙ„", "ÙˆØ±Ø¯", "Ø´ÙŠÙƒÙˆÙ„Ø§ØªØ©"], answer: "Ù…ÙˆØ¨Ø§ÙŠÙ„" },
  { question: "Ø³Ø§Ø±Ø© Ø¨ØªØºÙŠØ± Ø¹Ù„Ù‰ Ø±Ø§Ù…ÙŠ Ù„Ù…Ø§ØŸ", options: ["ÙŠØ´ØªØ±ÙŠ Ù„Ø¨Ø³ Ø¬Ø¯ÙŠØ¯", "ÙŠÙƒÙ„Ù… Ø¨Ù†Ø§Øª ÙÙŠ Ø§Ù„Ø´ØºÙ„", "ÙŠØ®Ø±Ø¬ Ù…Ø¹ ØµØ­Ø§Ø¨Ù‡"], answer: "ÙŠÙƒÙ„Ù… Ø¨Ù†Ø§Øª ÙÙŠ Ø§Ù„Ø´ØºÙ„" },
  { question: "Ø³Ø§Ø±Ø© Ù†ÙØ³Ù‡Ø§ ØªØ¹Ù…Ù„ Ø¥ÙŠÙ‡ Ø¨Ø¯Ù„ Ø§Ù„ÙØ±Ø­ØŸ", options: ["ØªØ³Ø§ÙØ±", "ØªØ´ØªØ±ÙŠ Ø¯Ù‡Ø¨ Ø£ÙƒØªØ±", "ØªØ¹Ù…Ù„ Ø¹Ù…Ø±Ø©"], answer: "ØªØ¹Ù…Ù„ Ø¹Ù…Ø±Ø©" },
  { question: "Ø¥ÙŠÙ‡ Ø£ÙƒØªØ± Ø­Ø§Ø¬Ø© Ø¨ØªØ­Ø¨Ù‡Ø§ Ø³Ø§Ø±Ø© Ù…Ù† Ø±Ø§Ù…ÙŠØŸ", options: ["ØµÙˆØªÙ‡", "Ø¶Ø­ÙƒÙ‡", "Ø¨ØµØªÙ‡ Ù„ÙŠÙ‡Ø§"], answer: "Ø¨ØµØªÙ‡ Ù„ÙŠÙ‡Ø§" },
  { question: "Ø¥ÙŠÙ‡ Ø§Ù„Ù„ÙŠ Ø³Ø§Ø±Ø© ÙƒØ§Ù†Øª Ù…ØªÙˆØªØ±Ø© Ù…Ù†Ù‡ØŸ", options: ["Ø±Ø§Ù…ÙŠ ÙŠØºÙŠØ± Ø¨Ø¹Ø¯ Ø§Ù„Ø¬ÙˆØ§Ø²", "Ø§Ù„Ù„Ø­Ù…Ø© Ù…Ø´ Ù…Ø¸Ø¨ÙˆØ·Ø©", "Ø§Ù„ÙØ±Ø­ Ù…Ø´ Ù‡ÙŠØ¹Ø¬Ø¨ Ø§Ù„Ù†Ø§Ø³"], answer: "Ø±Ø§Ù…ÙŠ ÙŠØºÙŠØ± Ø¨Ø¹Ø¯ Ø§Ù„Ø¬ÙˆØ§Ø²" },
  { question: "Ø±Ø§Ù…ÙŠ Ø¨ÙŠØ­Ø¨ Ø¥ÙŠÙ‡ Ù…Ù† Ø§Ù„Ø£ÙƒÙ„ØŸ", options: ["Ø§Ù„Ø´Ø·Ø©", "Ø·Ø¨Ù‚ Ø§Ù„ÙØ§ÙƒÙ‡Ø© Ø§Ù„Ù„ÙŠ Ø¨ØªØ¹Ù…Ù„Ù‡ Ø³Ø§Ø±Ø©", "Ø§Ù„Ù„Ø­Ù…Ø© Ø¨Ø³"], answer: "Ø·Ø¨Ù‚ Ø§Ù„ÙØ§ÙƒÙ‡Ø© Ø§Ù„Ù„ÙŠ Ø¨ØªØ¹Ù…Ù„Ù‡ Ø³Ø§Ø±Ø©" },
  { question: "Ø³Ø§Ø±Ø© Ø³Ù…Øª Ø±Ø§Ù…ÙŠ Ø¥ÙŠÙ‡ ÙÙŠ Ø§Ù„ØªÙ„ÙŠÙÙˆÙ†ØŸ", options: ["Ø±ÙˆØ­ÙŠ", "Ø³Ø¹Ø§Ø¯ØªÙŠ", "Ø­Ø¨ÙŠØ¨ÙŠ"], answer: "Ø³Ø¹Ø§Ø¯ØªÙŠ" },
  { question: "Ø±Ø§Ù…ÙŠ Ø¨Ø¹ØªÙ„Ù‡Ø§ Ø´ÙŠÙƒÙˆÙ„Ø§ØªØ© ÙˆÙˆØ±Ø¯ ÙÙŠ ÙŠÙˆÙ… Ø¥ÙŠÙ‡ØŸ", options: ["Ø´Ù… Ø§Ù„Ù†Ø³ÙŠÙ…", "Ø±Ù…Ø¶Ø§Ù†", "Ø¹ÙŠØ¯ Ø§Ù„ÙØ·Ø±"], answer: "Ø´Ù… Ø§Ù„Ù†Ø³ÙŠÙ…" },
  { question: "Ø³Ø§Ø±Ø© Ø¨ØªÙØ±Ø­ Ø¨Ø¥ÙŠÙ‡ Ø£ÙƒØªØ±ØŸ", options: ["Ø§Ù„Ù‡Ø¯Ø§ÙŠØ§ Ø§Ù„ØºØ§Ù„ÙŠØ©", "Ø¥Ù† Ø±Ø§Ù…ÙŠ ÙŠÙØªÙƒØ±Ù‡Ø§ ÙˆÙŠØ¬Ø¨Ù‡Ø§ Ø­Ø§Ø¬Ø§Øª Ø¨Ø³ÙŠØ·Ø©", "Ø§Ù„Ø®Ø±ÙˆØ¬"], answer: "Ø¥Ù† Ø±Ø§Ù…ÙŠ ÙŠÙØªÙƒØ±Ù‡Ø§ ÙˆÙŠØ¬Ø¨Ù‡Ø§ Ø­Ø§Ø¬Ø§Øª Ø¨Ø³ÙŠØ·Ø©" },
  { question: "Ø±Ø§Ù…ÙŠ Ø¨ÙŠÙ‚ÙˆÙ„ Ø³Ø§Ø±Ø© Ø¨ØªÙ‚ÙˆÙ„Ù‡ Ø¥ÙŠÙ‡ ÙÙŠ Ø§Ù„Ù‡Ø²Ø§Ø±ØŸ", options: ["Ù‡Ù…ÙˆØª ÙÙŠÙƒ", "ÙŠØ§ ÙƒØªÙƒÙˆØªÙŠ", "ÙŠØ§ Ù‚Ù„Ø¨ÙŠ"], answer: "ÙŠØ§ ÙƒØªÙƒÙˆØªÙŠ" },
  { question: "Ø³Ø§Ø±Ø© Ø¨ØªØ­Ø¨ ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª Ø¥ÙŠÙ‡ØŸ", options: ["Ø§Ù„Ø¶Ø­Ùƒ", "Ø­Ø¨ Ù‚Ø¯ÙŠÙ… Ø¹Ù„ÙŠÙ‡Ù… ØµÙˆØ±Ù‡Ù…", "Ø§Ù„Ø±Ø¹Ø¨"], answer: "Ø­Ø¨ Ù‚Ø¯ÙŠÙ… Ø¹Ù„ÙŠÙ‡Ù… ØµÙˆØ±Ù‡Ù…" },
  { question: "Ø¥ÙŠÙ‡ Ø§Ù„Ù…Ø´Ø±ÙˆØ¨ Ø§Ù„Ù„ÙŠ Ø±Ø§Ù…ÙŠ Ù…Ø¨ÙŠØ­Ø¨ÙˆØ´ØŸ", options: ["Ø³Ø­Ù„Ø¨", "ÙŠØ§Ù†Ø³ÙˆÙ†", "Ø§Ù„Ø´Ø§ÙŠ"], answer: "Ø§Ù„Ø´Ø§ÙŠ" },
  { question: "Ø¥ÙŠÙ‡ Ø£ÙƒØªØ± Ø­Ø§Ø¬Ø© Ø¨ØªÙØ±Ø­ Ø³Ø§Ø±Ø© ÙÙŠ Ø§Ù„Ù…ÙƒØ§Ù„Ù…Ø§ØªØŸ", options: ["Ø¹Ø¯Ø¯Ù‡Ø§", "Ù…Ø¯ØªÙ‡Ø§", "Ø¥Ù†Ù‡Ø§ Ø£ÙˆÙ„ ÙˆØ¢Ø®Ø± Ø­Ø§Ø¬Ø© Ù ÙŠÙˆÙ… Ø±Ø§Ù…ÙŠ"], answer: "Ø¥Ù†Ù‡Ø§ Ø£ÙˆÙ„ ÙˆØ¢Ø®Ø± Ø­Ø§Ø¬Ø© Ù ÙŠÙˆÙ… Ø±Ø§Ù…ÙŠ" },
  { question: "Ø±Ø§Ù…ÙŠ Ø¬Ø§Ø¨Ù„Ù‡Ø§ Ø´ÙŠØ¨Ø³ÙŠ Ø¨Ø·Ø¹Ù… Ø¥ÙŠÙ‡ØŸ", options: ["Ù…Ù„Ø­", "Ø´Ø·Ø©", "Ø¬Ø¨Ù†Ø©"], answer: "Ø´Ø·Ø©" },
];

const musicUrl = "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3"; // Ù…Ù…ÙƒÙ† ØªØºÙŠØ± Ø§Ù„Ø±Ø§Ø¨Ø· Ù‡Ù†Ø§

const Quiz = () => {
  const [currentQuestion, setCurrentQuestion] = useState(0);
  const [score, setScore] = useState(0);
  const [showResult, setShowResult] = useState(false);
  const [timeLeft, setTimeLeft] = useState(30);

  useEffect(() => {
    if (showResult) return; // ÙˆÙ‚Ù Ø§Ù„Ø¹Ø¯Ø§Ø¯ Ù„Ù…Ø§ ØªØ¸Ù‡Ø± Ø§Ù„Ù†ØªÙŠØ¬Ø©

    if (timeLeft === 0) {
      handleNext();
      return;
    }
    const timer = setTimeout(() => setTimeLeft(timeLeft - 1), 1000);
    return () => clearTimeout(timer);
  }, [timeLeft, showResult]);

  const handleAnswer = (selected) => {
    if (selected === questions[currentQuestion].answer) {
      setScore(score + 1);
    }
    handleNext();
  };

  const handleNext = () => {
    if (currentQuestion + 1 < questions.length) {
      setCurrentQuestion(currentQuestion + 1);
      setTimeLeft(30);
    } else {
      setShowResult(true);
    }
  };

  if (showResult) {
    const isHappy = score >= 20;
    return (
      <div className="p-4 text-center">
        <motion.h2
          className="text-2xl font-bold mb-4"
          initial={{ scale: 0 }}
          animate={{ scale: 1 }}
          transition={{ duration: 0.5 }}
        >
          {isHappy ? "Ø£Ø´Ø·Ø± ÙƒØªÙƒÙˆØª ğŸ£" : "Ù„ÙŠÙ‡ ÙƒØ¯Ù‡ ÙŠØ§ Ø±ÙˆØ­ÙŠØŸ ğŸ˜¢"}
        </motion.h2>
        <motion.img
          src={isHappy ? "https://i.imgur.com/w6bKZC3.png" : "https://i.imgur.com/QtZ6zDC.png"}
          alt="Ø§Ù„Ù†ØªÙŠØ¬Ø©"
          className="mx-auto rounded-xl w-64 h-64"
          initial={{ rotate: -10, opacity: 0 }}
          animate={{ rotate: 0, opacity: 1 }}
          transition={{ type: "spring", stiffness: 100, damping: 10 }}
        />
        <motion.p
          className="mt-4 text-xl"
          initial={{ y: 20, opacity: 0 }}
          animate={{ y: 0, opacity: 1 }}
          transition={{ delay: 0.5 }}
        >
          Ø¯Ø±Ø¬ØªÙƒ: {score} Ù…Ù† {questions.length}
        </motion.p>
      </div>
    );
  }

  return (
    <div className="p-4 max-w-xl mx-auto">
      <audio src={musicUrl} autoPlay loop />
      <div className="mb-4 flex justify-between items-center">
        <h2 className="text-lg font-bold">
          Ø§Ù„Ø³Ø¤Ø§Ù„ {currentQuestion + 1} Ù…Ù† {questions.length}
        </h2>
        <span className="text-red-500 font-bold">â± {timeLeft} Ø«Ø§Ù†ÙŠØ©</span>
      </div>
      <h3 className="text-xl font-semibold mb-4">{questions[currentQuestion].question}</h3>
      <div className="space-y-2">
        {questions[currentQuestion].options.map((option, idx) => (
          <button
            key={idx}
            onClick={() => handleAnswer(option)}
            className="w-full py-2 bg-blue-500 text-white rounded hover:bg-blue-600 transition"
          >
            {option}
          </button>
        ))}
      </div>
    </div>
  );
};

export default Quiz;
